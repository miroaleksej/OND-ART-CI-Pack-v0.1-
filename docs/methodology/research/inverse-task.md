# Обратная задача (справочные материалы)

Да — это уже правильная формулировка “обратной задачи OND” как инференса класса динамики, а не как восстановления (k) или (d). Ниже — что я бы точечно усилил, чтобы текст стал одновременно (а) формальным, (б) совместимым с OND-аксиоматикой из твоего файла, и (в) “reviewer-proof”.

1) Свести всё к канонической OND-рамке: (U_i=\pi(\sigma_i)) и (\Delta_i)
OND в твоём базовом документе строится вокруг наблюдаемых состояний (U_i\in\mathcal O) и наблюдаемой динамики (\Delta_i := U_{i+1}-U_i). Поэтому лучше явно сказать:
выбираем отображение наблюдения (\pi:\sigma\mapsto U\in\mathcal O);
считаем (\Delta_i);
все метрики и сравнения делаем относительно null model (i.i.d. uniform в (\mathcal O)).
Твоя парная “OND-связка” тогда становится вспомогательной конструкцией (feature map) для определения (\pi) или для обогащения (\mathcal O), но не “главной осью” (потому что она содержит неизвестные (k_i) и напрямую не вычисляется).
Практичная формулировка:
“инвариант задаёт семейство линейных ограничений на ((k_i,k_j)), а OND анализирует, как структура генератора проявляется в геометрии наблюдаемых проекций.”

2) Связать твои классы A/B/C с OND-классами I–IV (и это станет очень сильным местом)
У тебя A/B/C — по сути “модели дефекта”, а в файле уже есть OND-классы эквивалентности RNG по профилю метрик ((H_{\rm rank},H_{\rm sub},H_{\rm branch})).
Я бы сделал явное соответствие:
Класс C (Linear/Recurrent) → OND Class II (Low-Rank Generators): падает (H_{\rm rank}).
Класс A (Bounded Range / rejection-like ограничения) → OND Class III (Structured but Full-Rank): (H_{\rm rank}) может быть почти максимальным, но падают (H_{\rm sub}) и (H_{\rm branch}) из-за фаз/кластеров.
Класс B (Grid/Comb / конечный граф состояний) → чаще всего OND Class IV (Finite-State/Deterministic) или “III→IV” по мере усиления структуры: очень низкий (H_{\rm branch}).
Это превращает твою классификацию в естественное продолжение уже введённой OND-эквивалентности.

3) Формально определить метрики именно так, как в OND (и не изобретать заново)
Чтобы не было разночтений, лучше прямо использовать определения:
Rank-Entropy через сингулярные числа матрицы динамики (D).
Subspace Occupancy как энтропию биннинга после проекции на (\mathrm{span}{\Delta_i}).
Branching Index через кластеризацию (U_i) и распределение числа исходящих переходов.
Твои фразы “SVD матрицы связок” и “падение branching” отлично ложатся на это — нужно только привязать к каноническим обозначениям (H_{\rm rank}, H_{\rm sub}, H_{\rm branch}).

4) Уточнить, что именно является (\mathcal O) для ECDSA в этом разделе
Сейчас у тебя (\vec V=(r_js_i, r_is_j, D_{ij})) — это ок как “feature space”, но OND-парадигме проще, когда (\mathcal O) определено как пространство точек на подпись, а не на пару.
Минимальная правка без смены идеи:
(\mathcal O) — пространство наблюдений одного экземпляра подписи (например, (U_i=\pi(\sigma_i)));
парные объекты (D_{ij}) и ((r_js_i, r_is_j)) — это derived features для верификации/обогащения анализа, но динамика (\Delta_i) остаётся последовательной.
Так ты избежишь квадратичного “взрыва” (O(m^2)) как основной оси метода и сохранишь OND-канон.

5) “Проверка эргодичности по (D_{ij})” — переформулировать через Null Model OND
Слово “эргодичность” лучше заменить на:
“согласие с null model” (неотличимость профиля метрик от идеального процесса).
То есть:
не “(D_{ij}) равномерен в (\mathbb Z_n)”, а
“вычисленные OND-метрики на выбранном (\pi) статистически согласуются с null model”.
Это сильнее и более “OND-чисто”.

6) Golden Experiment — сделать центральным доказательным элементом
Ты правильно включил “золотой эталон”. В OND это прямо описано как контролируемое сравнение reference RNG vs modified RNG и принципиальный запрет на key recovery.
Я бы усилил формулировкой:
“Модели A/B/C валидируются только через golden experiment: одна и та же реализация подписи, один и тот же (pk), меняется только RNG.”
Это резко повышает научную состоятельность.

7) Готовая “отполированная” версия твоего раздела (можно вставлять как есть)
Ниже — компактный вариант “как в статье”, с минимальными изменениями смысла:
Inverse OND: Structural Inference of RNG Dynamics
Цель. Inverse OND решает не задачу восстановления секретов, а задачу идентификации класса дефекта RNG по наблюдаемой динамике подписей в пространстве (\mathcal O).
Наблюдения. Пусть (\pi:\sigma\mapsto U\in\mathcal O) — отображение подписи в наблюдаемое пространство. Определим наблюдаемую динамику (\Delta_i := U_{i+1}-U_i). Сравнение выполняется относительно null model (U_i\sim \text{i.i.d. uniform on }\mathcal O).
Парная OND-связка (инвариант исключения (d)). Для подписи ECDSA выполняется: [ r_j s_i k_i - r_i s_j k_j \equiv (r_j e_i - r_i e_j)\pmod n. ] Эта связка задаёт семейство линейных ограничений на скрытую случайность ((k_i)) и используется как источник производных признаков (derived features), не требуя инверсии (\pi).
OND-метрики. По выборке ({\Delta_i}) вычисляются: (1) (H_{\mathrm{rank}}) (эффективная размерность) через SVD; (2) (H_{\mathrm{sub}}) (равномерность заполнения подпространства); (3) (H_{\mathrm{branch}}) (конечносостояние/детерминизм) через кластеризацию (U_i) и переходы.
Классы инференса (дефекты RNG).
A — Bounded / rejection-like ограничения: (H_{\mathrm{sub}}\downarrow), часто (H_{\mathrm{branch}}\downarrow), при почти максимальном (H_{\mathrm{rank}}) (фазово-ограниченная динамика).
B — Grid/Comb / finite-state: выраженное падение (H_{\mathrm{branch}}) и кластеризация (ограниченный граф переходов).
C — Linear/Recurrent: падение (H_{\mathrm{rank}}) (динамика низкорангова).
Алгоритм инференса.
вычислить (U_i=\pi(\sigma_i)), затем (\Delta_i);
оценить ((H_{\mathrm{rank}},H_{\mathrm{sub}},H_{\mathrm{branch}}));
сопоставить профиль метрик с OND-классами эквивалентности RNG;
подтвердить интерпретацию через golden experiment: reference RNG vs modified RNG, без попыток криптоанализа.
Интерпретация. Inverse OND выявляет архитектурные дефекты RNG “раньше”, чем они станут достаточными для практического компрометационного сценария: метод возвращает diagnostic report / entropy profile, а не секреты.

Inverse OND: Structural Inference of RNG Dynamics
1. Концепция: Обратная задача как инференс
В рамках OND «обратная задача» (Inverse Problem) формулируется не как восстановление секретных ключей ($d$ или $k$), а как идентификация класса дефекта RNG на основе наблюдаемой динамики в пространстве $\mathcal{O}$.
Цель инференса — определить модель скрытого генератора, сопоставляя профиль наблюдаемых метрик с эталонными профилями OND-классов эквивалентности.
2. Формализация наблюдения ($\mathcal{O}, \Delta$)
Для анализа используется каноническая OND-рамка:
Отображение наблюдения: $\pi: \sigma \mapsto U \in \mathcal{O}$. Пространство $\mathcal{O}$ — это фазовое пространство подписи (например, нормализованные или проективные координаты).
Наблюдаемая динамика: $\Delta_i := U_{i+1} - U_i$. Анализируется вектор приращений состояний.
Null Model: Сравнение всех метрик проводится относительно гипотезы $H_0$ (i.i.d. uniform процесс в $\mathcal{O}$), что соответствует OND Class I (Ideal RNG).
Производные признаки (Derived Features)
Для ECDSA/EdDSA используется парная OND-связка (инвариант исключения $d$):

$$r_j s_i k_i - r_i s_j k_j \equiv (r_j e_i - r_i e_j) \pmod n$$
Данный инвариант служит источником признаков для оценки геометрических ограничений на скрытые переменные $k$, не требуя их прямого восстановления.
3. Классификация дефектов (Mapping to OND Classes)
Inverse OND сопоставляет физические дефекты RNG с формальными классами эквивалентности:
Модель дефекта
Описание (Природа)
Соответствие OND-классу
Профиль метрик
Класс A
Bounded/Interval (ограничение диапазона, MSB смещение)
Class III (Structured Full-Rank)
$H_{\rm sub} \downarrow$, $H_{\rm branch} \downarrow$, при $H_{\rm rank} \approx \max$
Класс B
Grid/Comb/Finite-State (LSB маски, ошибки кодирования)
Class IV (Deterministic/Finite)
Выраженное падение $H_{\rm branch}$, кластеризация в $\mathcal{O}$
Класс C
Algebraic/Recurrent (LCG, малые состояния, рекурсии)
Class II (Low-Rank)
Обвал $H_{\rm rank}$ (динамика низкорангова)
4. Алгоритм структурного инференса
Extraction: Вычисление последовательности $U_i$ и переходов $\Delta_i$.
Metric Evaluation: Расчет векторов $(H_{\rm rank}, H_{\rm sub}, H_{\rm branch})$:
$H_{\rm rank}$: через сингулярные числа (SVD) матрицы динамики.
$H_{\rm sub}$: энтропия заполнения (binning) после проекции на $\mathrm{span}\{\Delta_i\}$.
$H_{\rm branch}$: через анализ графа переходов между кластерами в $\mathcal{O}$.
Model Selection: Поиск минимума расстояния между профилем реальных данных и профилями, полученными в ходе Golden Experiment.
Validation (Golden Experiment): Контролируемое сравнение Reference RNG vs Modified RNG (с внесенной структурой) на идентичном публичном ключе. Важно: Любые попытки Key Recovery на этом этапе запрещены аксиоматикой OND.
5. Интерпретация результатов
Результатом работы Inverse OND является Diagnostic Report, содержащий:
Вероятностную принадлежность RNG к одному из классов (I–IV).
Оценку «структурной утечки» в битах (Entropy Gap).
Описание топологии ограничений (например, «циклическая зависимость с периодом $T$» или «интервальное отсечение в $2^{-a}$»).
Ниже — отшлифованная, “вставляемая в статью” версия твоего текста, полностью согласованная с канонической OND-рамкой (наблюдение (U_i=\pi(\sigma_i)), динамика (\Delta_i), null model, три метрики, golden experiment, классы I–IV, запрет key recovery).

Inverse OND: Structural Inference of RNG Dynamics
1. Концепция: обратная задача как инференс класса дефекта
В рамках OND обратная задача (Inverse Problem) формулируется не как восстановление скрытых величин (d) или (k), а как идентификация класса структурного дефекта RNG по наблюдаемой динамике артефактов протокола (подписей) в пространстве (\mathcal O). Результат — диагностический профиль (метрики/класс/неопределённость), а не криптоаналитический вывод.

2. Формальная модель наблюдения ((\mathcal O,\pi,\Delta))
Наблюдаемые данные. Пусть фиксирован публичный контекст (например, один и тот же публичный ключ (pk)) и дана последовательность валидных подписей ({\sigma_i}_{i=1}^N). Определим детерминированное отображение наблюдения [ \pi:\sigma\mapsto U\in\mathcal O, ] где (\mathcal O) — схемо-зависимое пространство наблюдений (для ECDSA-подобных схем типично (\mathbb Z_n^2)). Выбор (\pi) обязан быть публично определён и документирован.
Наблюдаемая динамика. Определим динамику как последовательность приращений [ \Delta_i := U_{i+1}-U_i,\qquad i=1,\dots,N-1, ] где вычитание берётся в окружающем пространстве наблюдений. Эта динамика инвариантна к аффинным сдвигам (\mathcal O), перепараметризации (\pi) и перестановкам координат, что делает метод устойчивым к деталям реализации.
Null model. Все метрики интерпретируются относительно нулевой гипотезы: [ H_0:\quad U_i \sim \text{i.i.d. uniform on }\mathcal O, ] что соответствует идеальному (OND-maximal) поведению.

3. Производные признаки (Derived Features) и “OND-связка”
Для ECDSA/EdDSA допустимо использовать производные признаки, мотивированные инвариантами исключения статических параметров. Например, парная связка вида [ r_j s_i k_i - r_i s_j k_j \equiv (r_j e_i - r_i e_j)\pmod n ] рассматривается не как уравнение для восстановления (k), а как источник геометрических/динамических ограничений на наблюдаемые проекции, которые можно проверять через профили ((H_{\rm rank},H_{\rm sub},H_{\rm branch})) и сравнение с эталонами. (В OND-терминах это “feature engineering” для выбора/обогащения (\pi), не требующее инверсии (\pi) и не предполагающее key recovery.)

4. Метрики OND (канонические определения)
Вычисляются три ортогональные метрики:
Rank-Entropy (H_{\rm rank}): энтропия по нормированным сингулярным числам матрицы динамики (D=[\Delta_i^\top]), измеряет эффективную размерность динамики.
Subspace Occupancy (H_{\rm sub}): энтропия заполнения биннинга после проекции (\Delta_i) на (V=\mathrm{span}{\Delta_i}), различает равномерное покрытие подпространства и кластеризацию даже при максимальном ранге.
Branching Index (H_{\rm branch}): энтропия распределения “ветвления” переходов между кластерами наблюдаемых состояний (U_i), диагностирует finite-state/автоматное поведение.

5. Mapping дефектов RNG → OND-классы эквивалентности (I–IV)
OND вводит эквивалентность RNG как совпадение предельного распределения метрик ((H_{\rm rank},H_{\rm sub},H_{\rm branch})) при (N\to\infty), и индуцирует классы I–IV. В этой рамке физические “модели дефекта” сопоставляются формальным классам так:
Модель дефекта
Природа
Соответствие OND-классу
Ожидаемый профиль метрик
A — Bounded/Interval
ограничение диапазона, фазово-ограниченная динамика (например, bounded noise / rejection-like эффекты)
Class III (Structured but Full-Rank)
(H_{\rm rank}\approx) максимум, при (H_{\rm sub}\downarrow), (H_{\rm branch}\downarrow)
B — Grid/Comb/Finite-State
маски/“дырки”/ошибки кодирования, конечное число режимов
Class IV (Finite-State/Deterministic)
выраженное падение (H_{\rm branch}), кластеризация, часто (H_{\rm rank}\downarrow)
C — Algebraic/Recurrent
LCG/рекурсии/малое внутреннее состояние → корреляции
Class II (Low-Rank)
(H_{\rm rank}\downarrow), при относительно нормальном (H_{\rm sub}), умеренном branching
(Формальные описания классов I–IV и их “подписи” метрик заданы в OND-описании.)

6. Алгоритм структурного инференса (без key recovery)
Extraction. Вычислить последовательность (U_i=\pi(\sigma_i)) и динамику (\Delta_i).
Metric evaluation. Посчитать ((H_{\rm rank},H_{\rm sub},H_{\rm branch})) в канонических определениях.
Model selection. Сопоставить профиль метрик наиболее близкому OND-классу/эталону (например, через расстояние в пространстве нормированных статистик и доверительные интервалы).
Validation: Golden Experiment. Подтвердить интерпретацию контролируемым сравнением “reference RNG” vs “modified RNG” при одном и том же публичном ключе, с заранее внесённой структурой (пониженный entropy pool, LCG, повтор seed и т.п.). Криптоатаки и key/state recovery запрещены: цель — валидация диагностических метрик.

7. Интерпретация и формат результата
Выход Inverse OND — Diagnostic Report, который включает:
вероятностную принадлежность к классам I–IV (например, по бутстрэповым CI и устойчивости при изменении (\pi,\varepsilon,K));
оценку “структурного разрыва” (Entropy Gap) как отклонение метрик от null model/эталона (например, (\Delta H_{\rm rank},\Delta H_{\rm sub},\Delta H_{\rm branch}) в естественных единицах энтропии);
качественное описание топологии ограничений (кластеризация/фазовость/цикличность/finite-state), согласованное с профилем метрик.
Важно: OND-ART принципиально не сводится к бинарному pass/fail — он возвращает статистики, интервалы и структурный профиль.

8. Заключение
Inverse OND выявляет архитектурные дефекты RNG на уровне наблюдаемой динамики после протокольной обработки, включая случаи, когда маргинальные распределения бит выглядят “нормально” и классические тесты уровня SP 800-22 могут не срабатывать. Это переводит аудит из режима “поиск эксплойта” в режим превентивной диагностики.

Inverse OND: Structural Inference of RNG Dynamics
1. Концепция: обратная задача как инференс класса дефекта
В рамках OND обратная задача (Inverse Problem) формулируется не как восстановление скрытых величин $d$ или $k$, а как идентификация класса структурного дефекта RNG по наблюдаемой динамике артефактов протокола (подписей) в пространстве $\mathcal{O}$. Результат — диагностический профиль (метрики/класс/неопределённость), а не криптоаналитический вывод.
2. Формальная модель наблюдения ($\mathcal{O}, \pi, \Delta$)
Notation:
$\{\sigma_i\}_{i=1}^N$ — последовательность валидных подписей.
$\pi: \sigma \mapsto U \in \mathcal{O}$ — детерминированное отображение наблюдения (для ECDSA типично $\mathcal{O} \subseteq \mathbb{Z}_n^2$).
$\Delta_i := U_{i+1} - U_i$ — наблюдаемая динамика (вектор приращений).
$H_0: U_i \sim \text{i.i.d. uniform on } \mathcal{O}$ — Null Model (идеальное поведение).
$\varepsilon, K$ — гиперпараметры биннинга и кластеризации для расчета метрик.
Принципы:
Выбор $\pi$ обязан быть публично определён и документирован.
Динамика $\Delta_i$ инвариантна к аффинным сдвигам и перепараметризациям $\mathcal{O}$.
Все метрики интерпретируются как отклонение от $H_0$.
3. Производные признаки и «OND-связка»
Для ECDSA/EdDSA используется парная связка (инвариант исключения $d$):

$$r_j s_i k_i - r_i s_j k_j \equiv (r_j e_i - r_i e_j) \pmod n$$
Данная конструкция рассматривается не как уравнение для взлома, а как источник геометрических ограничений на проекции. Это «feature engineering», позволяющий обогатить пространство $\mathcal{O}$ без инверсии $\pi$ и без попыток Key Recovery.
4. Канонические метрики OND
Rank-Entropy ($H_{\rm rank}$): Энтропия нормированных сингулярных чисел матрицы динамики $D=[\Delta_i^\top]$. Измеряет эффективную размерность системы.
Subspace Occupancy ($H_{\rm sub}$): Энтропия заполнения биннинга в $\mathrm{span}\{\Delta_i\}$. Диагностирует кластеризацию при высоком ранге.
Branching Index ($H_{\rm branch}$): Энтропия распределения ветвления переходов между кластерами состояний $U_i$. Выявляет автоматное (finite-state) поведение.
5. Mapping дефектов RNG → OND-классы эквивалентности
Модель дефекта
Природа
Класс OND
Профиль метрик
Класс A
Bounded/Interval (MSB смещение)
Class III
$H_{\rm rank} \approx \max$, $H_{\rm sub} \downarrow$, $H_{\rm branch} \downarrow$
Класс B
Grid/Comb (LSB маски, ошибки)
Class IV
$H_{\rm branch} \downarrow \downarrow$, выраженная кластеризация
Класс C
Algebraic/Recurrent (LCG, малые состояния)
Class II
$H_{\rm rank} \downarrow$, умеренный $H_{\rm sub}$
6. Алгоритм инференса и Model Selection
Extraction: Расчет $U_i$ и $\Delta_i$.
Evaluation: Расчет вектора профиля $P_{obs} = (H_{\rm rank}, H_{\rm sub}, H_{\rm branch})$.
Selection Rule: Минимизация расстояния $D(P_{obs}, P_{ref})$ до эталонных профилей, полученных в Golden Experiment:   $$\text{Class} = \arg\min_{c \in \{I, II, III, IV\}} \| P_{obs} - \mathbb{E}[P_{ref}^{(c)}] \|$$
Validation: Сравнение с модифицированным RNG (контролируемая структура) при том же $pk$. Key recovery запрещен.
7. Интерпретация и результат
Выход метода — Diagnostic Report:
Вероятностная принадлежность к классам I–IV.
Entropy Gap ($\Delta H$): Количественное отклонение от идеальной энтропии.
Топологическое описание (цикличность, фазовость, детерминизм).
8. Заключение
Inverse OND выявляет архитектурные дефекты RNG на уровне наблюдаемой динамики после протокольной обработки. Это переводит аудит из режима «поиска эксплойта» в режим превентивной структурной диагностики, работающей даже там, где стандартные статистические тесты (NIST SP 800-22) бессильны.
